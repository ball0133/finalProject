angular.module('finali0S')

.factory('FacebookService', function($auth, $http, $ionicPopup) {
    //Some fake testing data
    var facebookApiURL = 'https://graph.facebook.com/v2.2';

    return {
        search: function () {
            //asking for permission for the request of user information
            if ($auth.isAuthenticated()) {
                return $http.get(facebookApiURL + '/search', {
                    params: {
                        access_token: $auth.getToken(), //token generated by Satellizer
                        fields: 'id, name, link, gender, location, website, picture, relationship_status',
                        format: 'json'
                    }
                });
            } else {
                $ionicPopup.alert({
                    title: 'Error',
                    content: 'User Not Authorized'
                });
            }
        },
        
        stores: function () {
            //asking for permission for the request of user information
            if ($auth.isAuthenticated()) {
                return $http.get(facebookApiURL + '/stores', {
                    params: {
                        access_token: $auth.getToken(), //token generated by Satellizer
                        fields: 'id, name, link, gender, location, website, picture, relationship_status',
                        format: 'json'
                    }
                });
            } else {
                $ionicPopup.alert({
                    title: 'Error',
                    content: 'User Not Authorized'
                });
            }
        }
    };    
});
